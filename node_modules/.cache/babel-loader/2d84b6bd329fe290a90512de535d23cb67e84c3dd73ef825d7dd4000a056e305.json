{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maheswar\\\\OneDrive\\\\Desktop\\\\hedging\\\\Pro2\\\\flattrade\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport Dashboard from \"./components/Dashboard\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({\n    code: null,\n    client: null\n  });\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n    if (code && client) {\n      setAuthDetails({\n        code,\n        client\n      });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n  const fetchToken = async (key, code) => {\n    setLoading(true);\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto.SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          api_key: key,\n          request_code: code,\n          api_secret: shaSecret\n        })\n      });\n      const data = await response.json();\n      if (data !== null && data !== void 0 && data.token) {\n        localStorage.setItem(\"token\", data.token);\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col min-h-screen\",\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-grow p-4\",\n      children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading authentication data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 11\n      }, this) : authDetails.code && authDetails.client ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Authentication Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Code: \", authDetails.code]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Client: \", authDetails.client]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ApiHandler, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Redirecting to authentication...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"n3xGzx8ieA0cFOGU1ZpPY+AEHq0=\", false, function () {\n  return [useNavigate];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","ApiHandler","Dashboard","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s","apiKey","setApiKey","localStorage","getItem","authDetails","setAuthDetails","code","client","loading","setLoading","navigate","flattradeAuthUrl","queryParams","URLSearchParams","window","location","search","get","setItem","fetchToken","href","key","crypto","shaSecret","SHA256","toString","response","fetch","method","headers","body","JSON","stringify","api_key","request_code","api_secret","data","json","token","error","console","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Maheswar/OneDrive/Desktop/hedging/Pro2/flattrade/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport Dashboard from \"./components/Dashboard\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function App() {\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({ code: null, client: null });\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n\n    if (code && client) {\n      setAuthDetails({ code, client });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n\n  const fetchToken = async (key, code) => {\n    setLoading(true);\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto\n      .SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\")\n      .toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ api_key: key, request_code: code, api_secret: shaSecret }),\n      });\n      const data = await response.json();\n      if (data?.token) {\n        localStorage.setItem(\"token\", data.token);\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <main className=\"flex-grow p-4\">\n        {loading ? (\n          <p>Loading authentication data...</p>\n        ) : authDetails.code && authDetails.client ? (\n          <>\n            <h2 className=\"text-xl font-bold mb-4\">Authentication Details</h2>\n            <p>Code: {authDetails.code}</p>\n            <p>Client: {authDetails.client}</p>\n            <ApiHandler />\n            <Dashboard />\n          </>\n        ) : (\n          <p>Redirecting to authentication...</p>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}