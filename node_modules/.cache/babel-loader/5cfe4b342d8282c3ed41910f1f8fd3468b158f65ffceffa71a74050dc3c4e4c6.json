{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import Header from\"./components/Header\";import Footer from\"./components/Footer\";import Dashboard from\"./components/Dashboard\";import ApiHandler from\"./components/ApiHandler\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function App(){const[niftyPrice,setNiftyPrice]=useState(null);const[currentTime,setCurrentTime]=useState(new Date());const[apiKey,setApiKey]=useState(localStorage.getItem(\"apiKey\")||\"\");const[authDetails,setAuthDetails]=useState({code:null,client:null});const navigate=useNavigate();const flattradeAuthUrl=`https://auth.flattrade.in/?app_key=${apiKey}`;const apiEndpoints=[\"https://pi.flattrade.in/api/v1/marketdata/nifty50\",\"https://another-api.example.com/marketdata\"];useEffect(()=>{const fetchNiftyPrice=async()=>{try{const response=await fetch(apiEndpoints[0]);const data=await response.json();setNiftyPrice((data===null||data===void 0?void 0:data.strikePrice)||\"Unavailable\");}catch(error){console.error(\"Error fetching Nifty 50 price:\",error);}};fetchNiftyPrice();const interval=setInterval(fetchNiftyPrice,5000);return()=>clearInterval(interval);},[]);useEffect(()=>{const timer=setInterval(()=>setCurrentTime(new Date()),1000);return()=>clearInterval(timer);},[]);useEffect(()=>{const queryParams=new URLSearchParams(window.location.search);const code=queryParams.get(\"code\");const client=queryParams.get(\"client\");if(code&&client){setAuthDetails({code,client});localStorage.setItem(\"code\",code);localStorage.setItem(\"client\",client);fetchToken(apiKey,code);}else if(!apiKey){navigate(\"/api-key\");}else{window.location.href=flattradeAuthUrl;}},[apiKey]);const fetchToken=async(key,code)=>{const crypto=await import(\"crypto-js\");const shaSecret=crypto.SHA256(key+code+\"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();try{const response=await fetch(\"/.netlify/functions/fetchToken\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({api_key:key,request_code:code,api_secret:shaSecret})});const data=await response.json();if(data!==null&&data!==void 0&&data.token){localStorage.setItem(\"token\",data.token);}}catch(error){console.error(\"Token fetch failed:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col min-h-screen\",children:[/*#__PURE__*/_jsx(Header,{niftyPrice:niftyPrice}),/*#__PURE__*/_jsxs(\"main\",{className:\"flex-grow p-4\",children:[authDetails.code&&authDetails.client?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold mb-4\",children:\"Authentication Details\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Code: \",authDetails.code]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Client: \",authDetails.client]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Redirecting to authentication...\"}),/*#__PURE__*/_jsx(ApiHandler,{apiEndpoints:apiEndpoints}),/*#__PURE__*/_jsx(Dashboard,{})]}),/*#__PURE__*/_jsx(Footer,{currentTime:currentTime.toLocaleString(\"en-IN\",{timeZone:\"Asia/Kolkata\"})})]});}","map":{"version":3,"names":["React","useState","useEffect","Header","Footer","Dashboard","ApiHandler","useNavigate","jsx","_jsx","jsxs","_jsxs","App","niftyPrice","setNiftyPrice","currentTime","setCurrentTime","Date","apiKey","setApiKey","localStorage","getItem","authDetails","setAuthDetails","code","client","navigate","flattradeAuthUrl","apiEndpoints","fetchNiftyPrice","response","fetch","data","json","strikePrice","error","console","interval","setInterval","clearInterval","timer","queryParams","URLSearchParams","window","location","search","get","setItem","fetchToken","href","key","crypto","shaSecret","SHA256","toString","method","headers","body","JSON","stringify","api_key","request_code","api_secret","token","className","children","toLocaleString","timeZone"],"sources":["C:/Users/Maheswar/OneDrive/Desktop/hedging/Pro2/flattrade/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Dashboard from \"./components/Dashboard\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function App() {\n  const [niftyPrice, setNiftyPrice] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({ code: null, client: null });\n  const navigate = useNavigate();\n\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  const apiEndpoints = [\n    \"https://pi.flattrade.in/api/v1/marketdata/nifty50\",\n    \"https://another-api.example.com/marketdata\",\n  ];\n\n  useEffect(() => {\n    const fetchNiftyPrice = async () => {\n      try {\n        const response = await fetch(apiEndpoints[0]);\n        const data = await response.json();\n        setNiftyPrice(data?.strikePrice || \"Unavailable\");\n      } catch (error) {\n        console.error(\"Error fetching Nifty 50 price:\", error);\n      }\n    };\n\n    fetchNiftyPrice();\n    const interval = setInterval(fetchNiftyPrice, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n\n    if (code && client) {\n      setAuthDetails({ code, client });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n\n  const fetchToken = async (key, code) => {\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto.SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ api_key: key, request_code: code, api_secret: shaSecret }),\n      });\n      const data = await response.json();\n      if (data?.token) {\n        localStorage.setItem(\"token\", data.token);\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <Header niftyPrice={niftyPrice} />\n      <main className=\"flex-grow p-4\">\n        {authDetails.code && authDetails.client ? (\n          <div>\n            <h2 className=\"text-xl font-bold mb-4\">Authentication Details</h2>\n            <p>Code: {authDetails.code}</p>\n            <p>Client: {authDetails.client}</p>\n          </div>\n        ) : (\n          <p>Redirecting to authentication...</p>\n        )}\n        <ApiHandler apiEndpoints={apiEndpoints} />\n        <Dashboard />\n      </main>\n      <Footer\n        currentTime={currentTime.toLocaleString(\"en-IN\", {\n          timeZone: \"Asia/Kolkata\",\n        })}\n      />\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}