{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maheswar\\\\OneDrive\\\\Desktop\\\\hedging\\\\Pro2\\\\flattrade\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Dashboard from \"./components/Dashboard\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n  const [niftyPrice, setNiftyPrice] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({\n    code: null,\n    client: null\n  });\n  const navigate = useNavigate();\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  const apiEndpoints = [\"https://pi.flattrade.in/api/v1/marketdata/nifty50\", \"https://another-api.example.com/marketdata\"];\n  useEffect(() => {\n    const fetchNiftyPrice = async () => {\n      try {\n        const response = await fetch(apiEndpoints[0]);\n        const data = await response.json();\n        setNiftyPrice((data === null || data === void 0 ? void 0 : data.strikePrice) || \"Unavailable\");\n      } catch (error) {\n        console.error(\"Error fetching Nifty 50 price:\", error);\n      }\n    };\n    fetchNiftyPrice();\n    const interval = setInterval(fetchNiftyPrice, 5000);\n    return () => clearInterval(interval);\n  }, []);\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n    if (code && client) {\n      setAuthDetails({\n        code,\n        client\n      });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n  const fetchToken = async (key, code) => {\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto.SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          api_key: key,\n          request_code: code,\n          api_secret: shaSecret\n        })\n      });\n      const data = await response.json();\n      if (data !== null && data !== void 0 && data.token) {\n        localStorage.setItem(\"token\", data.token);\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col min-h-screen\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      niftyPrice: niftyPrice\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-grow p-4\",\n      children: [authDetails.code && authDetails.client ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Authentication Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Code: \", authDetails.code]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Client: \", authDetails.client]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Redirecting to authentication...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(ApiHandler, {\n        apiEndpoints: apiEndpoints\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {\n      currentTime: currentTime.toLocaleString(\"en-IN\", {\n        timeZone: \"Asia/Kolkata\"\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"SOu1uHhI/gZs/qIJV5SQXCpaO44=\", false, function () {\n  return [useNavigate];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","Header","Footer","Dashboard","ApiHandler","useNavigate","jsxDEV","_jsxDEV","App","_s","niftyPrice","setNiftyPrice","currentTime","setCurrentTime","Date","apiKey","setApiKey","localStorage","getItem","authDetails","setAuthDetails","code","client","navigate","flattradeAuthUrl","apiEndpoints","fetchNiftyPrice","response","fetch","data","json","strikePrice","error","console","interval","setInterval","clearInterval","timer","queryParams","URLSearchParams","window","location","search","get","setItem","fetchToken","href","key","crypto","shaSecret","SHA256","toString","method","headers","body","JSON","stringify","api_key","request_code","api_secret","token","className","children","fileName","_jsxFileName","lineNumber","columnNumber","toLocaleString","timeZone","_c","$RefreshReg$"],"sources":["C:/Users/Maheswar/OneDrive/Desktop/hedging/Pro2/flattrade/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Dashboard from \"./components/Dashboard\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function App() {\n  const [niftyPrice, setNiftyPrice] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({ code: null, client: null });\n  const navigate = useNavigate();\n\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  const apiEndpoints = [\n    \"https://pi.flattrade.in/api/v1/marketdata/nifty50\",\n    \"https://another-api.example.com/marketdata\",\n  ];\n\n  useEffect(() => {\n    const fetchNiftyPrice = async () => {\n      try {\n        const response = await fetch(apiEndpoints[0]);\n        const data = await response.json();\n        setNiftyPrice(data?.strikePrice || \"Unavailable\");\n      } catch (error) {\n        console.error(\"Error fetching Nifty 50 price:\", error);\n      }\n    };\n\n    fetchNiftyPrice();\n    const interval = setInterval(fetchNiftyPrice, 5000);\n    return () => clearInterval(interval);\n  }, []);\n\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n\n    if (code && client) {\n      setAuthDetails({ code, client });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n\n  const fetchToken = async (key, code) => {\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto.SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ api_key: key, request_code: code, api_secret: shaSecret }),\n      });\n      const data = await response.json();\n      if (data?.token) {\n        localStorage.setItem(\"token\", data.token);\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <Header niftyPrice={niftyPrice} />\n      <main className=\"flex-grow p-4\">\n        {authDetails.code && authDetails.client ? (\n          <div>\n            <h2 className=\"text-xl font-bold mb-4\">Authentication Details</h2>\n            <p>Code: {authDetails.code}</p>\n            <p>Client: {authDetails.client}</p>\n          </div>\n        ) : (\n          <p>Redirecting to authentication...</p>\n        )}\n        <ApiHandler apiEndpoints={apiEndpoints} />\n        <Dashboard />\n      </main>\n      <Footer\n        currentTime={currentTime.toLocaleString(\"en-IN\", {\n          timeZone: \"Asia/Kolkata\",\n        })}\n      />\n    </div>\n  );\n}"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,MAAM,MAAM,qBAAqB;AACxC,OAAOC,MAAM,MAAM,qBAAqB;AACxC,OAAOC,SAAS,MAAM,wBAAwB;AAC9C,OAAOC,UAAU,MAAM,yBAAyB;AAChD,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE/C,eAAe,SAASC,GAAGA,CAAA,EAAG;EAAAC,EAAA;EAC5B,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAClD,MAAM,CAACa,WAAW,EAAEC,cAAc,CAAC,GAAGd,QAAQ,CAAC,IAAIe,IAAI,CAAC,CAAC,CAAC;EAC1D,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAGjB,QAAQ,CAACkB,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;EAC1E,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGrB,QAAQ,CAAC;IAAEsB,IAAI,EAAE,IAAI;IAAEC,MAAM,EAAE;EAAK,CAAC,CAAC;EAC5E,MAAMC,QAAQ,GAAGlB,WAAW,CAAC,CAAC;EAE9B,MAAMmB,gBAAgB,GAAG,sCAAsCT,MAAM,EAAE;EACvE,MAAMU,YAAY,GAAG,CACnB,mDAAmD,EACnD,4CAA4C,CAC7C;EAEDzB,SAAS,CAAC,MAAM;IACd,MAAM0B,eAAe,GAAG,MAAAA,CAAA,KAAY;MAClC,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACH,YAAY,CAAC,CAAC,CAAC,CAAC;QAC7C,MAAMI,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;QAClCnB,aAAa,CAAC,CAAAkB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEE,WAAW,KAAI,aAAa,CAAC;MACnD,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACxD;IACF,CAAC;IAEDN,eAAe,CAAC,CAAC;IACjB,MAAMQ,QAAQ,GAAGC,WAAW,CAACT,eAAe,EAAE,IAAI,CAAC;IACnD,OAAO,MAAMU,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,EAAE,CAAC;EAENlC,SAAS,CAAC,MAAM;IACd,MAAMqC,KAAK,GAAGF,WAAW,CAAC,MAAMtB,cAAc,CAAC,IAAIC,IAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC;IACjE,OAAO,MAAMsB,aAAa,CAACC,KAAK,CAAC;EACnC,CAAC,EAAE,EAAE,CAAC;EAENrC,SAAS,CAAC,MAAM;IACd,MAAMsC,WAAW,GAAG,IAAIC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;IAC/D,MAAMrB,IAAI,GAAGiB,WAAW,CAACK,GAAG,CAAC,MAAM,CAAC;IACpC,MAAMrB,MAAM,GAAGgB,WAAW,CAACK,GAAG,CAAC,QAAQ,CAAC;IAExC,IAAItB,IAAI,IAAIC,MAAM,EAAE;MAClBF,cAAc,CAAC;QAAEC,IAAI;QAAEC;MAAO,CAAC,CAAC;MAChCL,YAAY,CAAC2B,OAAO,CAAC,MAAM,EAAEvB,IAAI,CAAC;MAClCJ,YAAY,CAAC2B,OAAO,CAAC,QAAQ,EAAEtB,MAAM,CAAC;MACtCuB,UAAU,CAAC9B,MAAM,EAAEM,IAAI,CAAC;IAC1B,CAAC,MAAM,IAAI,CAACN,MAAM,EAAE;MAClBQ,QAAQ,CAAC,UAAU,CAAC;IACtB,CAAC,MAAM;MACLiB,MAAM,CAACC,QAAQ,CAACK,IAAI,GAAGtB,gBAAgB;IACzC;EACF,CAAC,EAAE,CAACT,MAAM,CAAC,CAAC;EAEZ,MAAM8B,UAAU,GAAG,MAAAA,CAAOE,GAAG,EAAE1B,IAAI,KAAK;IACtC,MAAM2B,MAAM,GAAG,MAAM,MAAM,CAAC,WAAW,CAAC;IACxC,MAAMC,SAAS,GAAGD,MAAM,CAACE,MAAM,CAACH,GAAG,GAAG1B,IAAI,GAAG,uDAAuD,CAAC,CAAC8B,QAAQ,CAAC,CAAC;IAChH,IAAI;MACF,MAAMxB,QAAQ,GAAG,MAAMC,KAAK,CAAC,gCAAgC,EAAE;QAC7DwB,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEC,OAAO,EAAEV,GAAG;UAAEW,YAAY,EAAErC,IAAI;UAAEsC,UAAU,EAAEV;QAAU,CAAC;MAClF,CAAC,CAAC;MACF,MAAMpB,IAAI,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;MAClC,IAAID,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAE+B,KAAK,EAAE;QACf3C,YAAY,CAAC2B,OAAO,CAAC,OAAO,EAAEf,IAAI,CAAC+B,KAAK,CAAC;MAC3C;IACF,CAAC,CAAC,OAAO5B,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC7C;EACF,CAAC;EAED,oBACEzB,OAAA;IAAKsD,SAAS,EAAC,4BAA4B;IAAAC,QAAA,gBACzCvD,OAAA,CAACN,MAAM;MAACS,UAAU,EAAEA;IAAW;MAAAqD,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAClC3D,OAAA;MAAMsD,SAAS,EAAC,eAAe;MAAAC,QAAA,GAC5B3C,WAAW,CAACE,IAAI,IAAIF,WAAW,CAACG,MAAM,gBACrCf,OAAA;QAAAuD,QAAA,gBACEvD,OAAA;UAAIsD,SAAS,EAAC,wBAAwB;UAAAC,QAAA,EAAC;QAAsB;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAClE3D,OAAA;UAAAuD,QAAA,GAAG,QAAM,EAAC3C,WAAW,CAACE,IAAI;QAAA;UAAA0C,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC/B3D,OAAA;UAAAuD,QAAA,GAAG,UAAQ,EAAC3C,WAAW,CAACG,MAAM;QAAA;UAAAyC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAChC,CAAC,gBAEN3D,OAAA;QAAAuD,QAAA,EAAG;MAAgC;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAG,CACvC,eACD3D,OAAA,CAACH,UAAU;QAACqB,YAAY,EAAEA;MAAa;QAAAsC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC1C3D,OAAA,CAACJ,SAAS;QAAA4D,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACT,CAAC,eACP3D,OAAA,CAACL,MAAM;MACLU,WAAW,EAAEA,WAAW,CAACuD,cAAc,CAAC,OAAO,EAAE;QAC/CC,QAAQ,EAAE;MACZ,CAAC;IAAE;MAAAL,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACJ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV;AAACzD,EAAA,CA5FuBD,GAAG;EAAA,QAKRH,WAAW;AAAA;AAAAgE,EAAA,GALN7D,GAAG;AAAA,IAAA6D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}