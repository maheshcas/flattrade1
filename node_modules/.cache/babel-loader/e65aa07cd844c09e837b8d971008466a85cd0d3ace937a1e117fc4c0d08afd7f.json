{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Maheswar\\\\OneDrive\\\\Desktop\\\\hedging\\\\Pro2\\\\flattrade\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Dashboard from \"./components/Dashboard\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n  const [niftyPrice, setNiftyPrice] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({\n    code: null,\n    client: null\n  });\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  const apiEndpoints = [\"https://pi.flattrade.in/api/v1/marketdata/nifty50\"];\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n    if (code && client) {\n      setAuthDetails({\n        code,\n        client\n      });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n  const fetchToken = async (key, code) => {\n    setLoading(true);\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto.SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\").toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          api_key: key,\n          request_code: code,\n          api_secret: shaSecret\n        })\n      });\n      const data = await response.json();\n      if (data !== null && data !== void 0 && data.token) {\n        localStorage.setItem(\"token\", data.token);\n        fetchNiftyPrice();\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const fetchNiftyPrice = async () => {\n    try {\n      const response = await fetch(apiEndpoints[0]);\n      const data = await response.json();\n      setNiftyPrice((data === null || data === void 0 ? void 0 : data.strikePrice) || \"Unavailable\");\n    } catch (error) {\n      console.error(\"Error fetching Nifty 50 price:\", error);\n    }\n  };\n  useEffect(() => {\n    if (authDetails.code && authDetails.client) {\n      fetchNiftyPrice();\n      const interval = setInterval(fetchNiftyPrice, 5000);\n      return () => clearInterval(interval);\n    }\n  }, [authDetails]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col min-h-screen\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      niftyPrice: niftyPrice\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"flex-grow p-4\",\n      children: loading ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading authentication and market data...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this) : authDetails.code && authDetails.client ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-xl font-bold mb-4\",\n          children: \"Authentication Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Code: \", authDetails.code]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Client: \", authDetails.client]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(ApiHandler, {\n          apiEndpoints: apiEndpoints\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Dashboard, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Redirecting to authentication...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {\n      currentTime: currentTime.toLocaleString(\"en-IN\", {\n        timeZone: \"Asia/Kolkata\"\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"HnJfNsKrie6BBnI6pvNnLhj93l4=\", false, function () {\n  return [useNavigate];\n});\n_c = App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","Header","Footer","Dashboard","ApiHandler","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s","niftyPrice","setNiftyPrice","currentTime","setCurrentTime","Date","apiKey","setApiKey","localStorage","getItem","authDetails","setAuthDetails","code","client","loading","setLoading","navigate","flattradeAuthUrl","apiEndpoints","timer","setInterval","clearInterval","queryParams","URLSearchParams","window","location","search","get","setItem","fetchToken","href","key","crypto","shaSecret","SHA256","toString","response","fetch","method","headers","body","JSON","stringify","api_key","request_code","api_secret","data","json","token","fetchNiftyPrice","error","console","strikePrice","interval","className","children","fileName","_jsxFileName","lineNumber","columnNumber","toLocaleString","timeZone","_c","$RefreshReg$"],"sources":["C:/Users/Maheswar/OneDrive/Desktop/hedging/Pro2/flattrade/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport Dashboard from \"./components/Dashboard\";\nimport ApiHandler from \"./components/ApiHandler\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function App() {\n  const [niftyPrice, setNiftyPrice] = useState(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n  const [apiKey, setApiKey] = useState(localStorage.getItem(\"apiKey\") || \"\");\n  const [authDetails, setAuthDetails] = useState({ code: null, client: null });\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n\n  const flattradeAuthUrl = `https://auth.flattrade.in/?app_key=${apiKey}`;\n  const apiEndpoints = [\"https://pi.flattrade.in/api/v1/marketdata/nifty50\"];\n\n  useEffect(() => {\n    const timer = setInterval(() => setCurrentTime(new Date()), 1000);\n    return () => clearInterval(timer);\n  }, []);\n\n  useEffect(() => {\n    const queryParams = new URLSearchParams(window.location.search);\n    const code = queryParams.get(\"code\");\n    const client = queryParams.get(\"client\");\n\n    if (code && client) {\n      setAuthDetails({ code, client });\n      localStorage.setItem(\"code\", code);\n      localStorage.setItem(\"client\", client);\n      fetchToken(apiKey, code);\n    } else if (!apiKey) {\n      navigate(\"/api-key\");\n    } else {\n      window.location.href = flattradeAuthUrl;\n    }\n  }, [apiKey]);\n\n  const fetchToken = async (key, code) => {\n    setLoading(true);\n    const crypto = await import(\"crypto-js\");\n    const shaSecret = crypto\n      .SHA256(key + code + \"2025.8199821099b74d748969f3143d73a3b1481bebed356ccf4d\")\n      .toString();\n    try {\n      const response = await fetch(\"/.netlify/functions/fetchToken\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ api_key: key, request_code: code, api_secret: shaSecret }),\n      });\n      const data = await response.json();\n      if (data?.token) {\n        localStorage.setItem(\"token\", data.token);\n        fetchNiftyPrice();\n      }\n    } catch (error) {\n      console.error(\"Token fetch failed:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchNiftyPrice = async () => {\n    try {\n      const response = await fetch(apiEndpoints[0]);\n      const data = await response.json();\n      setNiftyPrice(data?.strikePrice || \"Unavailable\");\n    } catch (error) {\n      console.error(\"Error fetching Nifty 50 price:\", error);\n    }\n  };\n\n  useEffect(() => {\n    if (authDetails.code && authDetails.client) {\n      fetchNiftyPrice();\n      const interval = setInterval(fetchNiftyPrice, 5000);\n      return () => clearInterval(interval);\n    }\n  }, [authDetails]);\n\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <Header niftyPrice={niftyPrice} />\n      <main className=\"flex-grow p-4\">\n        {loading ? (\n          <p>Loading authentication and market data...</p>\n        ) : (\n          authDetails.code && authDetails.client ? (\n            <>\n              <h2 className=\"text-xl font-bold mb-4\">Authentication Details</h2>\n              <p>Code: {authDetails.code}</p>\n              <p>Client: {authDetails.client}</p>\n              <ApiHandler apiEndpoints={apiEndpoints} />\n              <Dashboard />\n            </>\n          ) : (\n            <p>Redirecting to authentication...</p>\n          )\n        )}\n      </main>\n      <Footer\n        currentTime={currentTime.toLocaleString(\"en-IN\", {\n          timeZone: \"Asia/Kolkata\",\n        })}\n      />\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}